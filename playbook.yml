---
- hosts: all

  pre_tasks:
    - name: Create Install dir where we'll store all our binaries
      file: path=/AnsibleInstall state=directory

  vars_files:
    - ./configs/config.yml

  # sudo: true

  tasks:
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: tensorflow }, when: install.role.tensorflow == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: foxitreader }, when: install.role.foxitreader == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: repos }, when: install.role.repos == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: anaconda }, when: install.role.anaconda == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: intellij }, when: install.role.intellij == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: kafka }, when: install.role.kafka == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: kubernetes }, when: install.role.kubernetes == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: vs_code }, when: install.role.vs_code == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: postman }, when: install.role.postman == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: smartgit }, when: install.role.smartgit == true }
    - { include_role: { name: do_if_not_success }, vars: { role_to_run: helm }, when: install.role.helm == true }

      # Set git stuff
    - name: "Set git stuff"
      block:
      - name: "Set git user email"
        shell: git config --global user.email "damxam@gmail.com"
        become: yes
        become_user: damxam
      - name: "Set git user name"
        shell: git config --global user.name "Max Wittmann"
        become: yes
        become_user: damxam

    - name: "Add user to vboxsf group (virtualbox-specific)"
      command: "adduser damxam vboxsf"
      ignore_errors: yes

    - name: "Add user to docker group"
      command: "adduser damxam docker"

    # This will fail / be useless on non-nautilus distros; should start adding
    # some conditional logic
    - name: "Set my custom nautilus bookmarks (warning, overwrites existing)"
      copy:
        src: files/bookmarks
        dest: /home/damxam/.config/gtk-3.0
        owner: damxam
        group: damxam
